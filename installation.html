<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Installation &mdash; homogenised-finite-elements 0.9.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="_static/css/theme.css?v=19f00094" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="_static/documentation_options.js?v=39bb1c6d"></script>
        <script src="_static/doctools.js?v=9a2dae69"></script>
        <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Configuration" href="configuration.html" />
    <link rel="prev" title="Getting Started" href="modules.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            homogenised-finite-elements
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Getting Started</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#building-dependencies">Building Dependencies</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-docker-image">Running the Docker Image</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-the-project">Running the Project</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-the-docker-image-in-apptainer">Building the Docker image in Apptainer</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#work-interactively">Work interactively</a></li>
<li class="toctree-l4"><a class="reference internal" href="#execute-the-containers-runscript">Execute the containers “runscript”</a></li>
<li class="toctree-l4"><a class="reference internal" href="#run-a-command-within-your-container-image">Run a command within your container image</a></li>
<li class="toctree-l4"><a class="reference internal" href="#bind-directories">Bind directories</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="configuration.html">Configuration</a></li>
<li class="toctree-l2"><a class="reference internal" href="development.html">Development</a></li>
<li class="toctree-l2"><a class="reference internal" href="contributing.html">Contributing</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="modules.html#homogenised-finite-elements-pipeline">Homogenised Finite Elements Pipeline</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">homogenised-finite-elements</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Getting Started</a></li>
      <li class="breadcrumb-item active">Installation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/installation.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="installation">
<h1>Installation<a class="headerlink" href="#installation" title="Link to this heading">¶</a></h1>
<section id="building-dependencies">
<h2>Building Dependencies<a class="headerlink" href="#building-dependencies" title="Link to this heading">¶</a></h2>
<p>This project uses Docker to manage its dependencies. To build the Docker
image, follow these steps:</p>
<ol class="arabic simple">
<li><p>Install Docker on your machine if you haven’t already. You can
download it from
<a class="reference external" href="https://www.docker.com/products/docker-desktop">here</a>.</p></li>
<li><p>Navigate to the project directory that contains the Dockerfile. In
this case, it’s the <code class="docutils literal notranslate"><span class="pre">02_CODE</span></code> directory.</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>02_CODE
</pre></div>
</div>
<ol class="arabic simple">
<li><p>Build the Docker image using the Dockerfile.ubuntu24.04 file. Replace
your_image_name with the name you want to give to your Docker image.</p></li>
</ol>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>your_image_name<span class="w"> </span>-f<span class="w"> </span>Dockerfile.ubuntu24.04<span class="w"> </span>.
</pre></div>
</div>
</section>
<section id="running-the-docker-image">
<h2>Running the Docker Image<a class="headerlink" href="#running-the-docker-image" title="Link to this heading">¶</a></h2>
<p>After building the Docker image, you can run it using the following
command:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>docker<span class="w"> </span>run<span class="w"> </span>-it<span class="w"> </span>your_image_name
</pre></div>
</div>
<p>This will start a Docker container with the built image and open an
interactive shell in the container. The Docker container has all the
dependencies installed and the environment set up as specified in the
Dockerfile.</p>
</section>
<section id="running-the-project">
<h2>Running the Project<a class="headerlink" href="#running-the-project" title="Link to this heading">¶</a></h2>
<p>Once you’re inside the Docker container, you can run the project. The
exact command depends on how your project is structured, but it will
generally look something like this:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>conda<span class="w"> </span>init
<span class="nb">source</span><span class="w"> </span>.bashrc
conda<span class="w"> </span>activate<span class="w"> </span>hfe-essentials
<span class="nb">cd</span><span class="w"> </span>02_CODE
python<span class="w"> </span>src/pipeline_runner.py
</pre></div>
</div>
</section>
<section id="building-the-docker-image-in-apptainer">
<h2>Building the Docker image in Apptainer<a class="headerlink" href="#building-the-docker-image-in-apptainer" title="Link to this heading">¶</a></h2>
<p>When working on HPC, it might be necessary to run the container in
Apptainer. You can pull the Docker image directly from Docker Hub:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>apptainer<span class="w"> </span>build<span class="w"> </span>--sandbox<span class="w"> </span>hfe_development.sif<span class="w"> </span>docker://simoneponcioni/hfe_development:latest
</pre></div>
</div>
<p>Once it’s downloaded, run it following these steps:</p>
<section id="work-interactively">
<h3>Work interactively<a class="headerlink" href="#work-interactively" title="Link to this heading">¶</a></h3>
<p>Submit an interactive SLURM job and then use the shell command to spawn
an interactive shell within the Singularity container:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>srun<span class="w"> </span>--time<span class="o">=</span><span class="m">01</span>:00:00<span class="w"> </span>--mem-per-cpu<span class="o">=</span>2G<span class="w"> </span>--pty<span class="w"> </span>bash
apptainer<span class="w"> </span>shell<span class="w"> </span>&lt;image&gt;
</pre></div>
</div>
</section>
<section id="execute-the-containers-runscript">
<h3>Execute the containers “runscript”<a class="headerlink" href="#execute-the-containers-runscript" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>
<span class="c1">#SBATCH --partition=all</span>
<span class="c1">#SBATCH --mem-per-cpu=2G</span>

apptainer<span class="w"> </span>run<span class="w"> </span>&lt;image&gt;<span class="w">   </span><span class="c1">#or ./&lt;image&gt;</span>
</pre></div>
</div>
</section>
<section id="run-a-command-within-your-container-image">
<h3>Run a command within your container image<a class="headerlink" href="#run-a-command-within-your-container-image" title="Link to this heading">¶</a></h3>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>apptainer<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>&lt;image&gt;<span class="w"> </span>&lt;command&gt;

e.g:
apptainer<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>container.img<span class="w"> </span>cat<span class="w"> </span>/etc/os-release
</pre></div>
</div>
</section>
<section id="bind-directories">
<h3>Bind directories<a class="headerlink" href="#bind-directories" title="Link to this heading">¶</a></h3>
<p>Per default the started application (e.g. cat in the last example) runs
withing the container. The container works like a seperate machine with
own operation system etc. Thus, per default you have no access to files
and directories outside the container. This can be changed using binding
paths.</p>
<p>If files are needed outside the container, e.g. in your HOME you can add
the path to APPTAINER_BINDPATH=“src1[:dest1],src2[:dest2]. All
subdirectories and files will be accessible. Thus you could bind your
HOME directory as:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">APPTAINER_BINDPATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">/:</span><span class="nv">$HOME</span><span class="s2">/&quot;</span>
<span class="c1"># or simply</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">APPTAINER_BINDPATH</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$HOME</span><span class="s2">&quot;</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="modules.html" class="btn btn-neutral float-left" title="Getting Started" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="configuration.html" class="btn btn-neutral float-right" title="Configuration" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Simone Poncioni.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>